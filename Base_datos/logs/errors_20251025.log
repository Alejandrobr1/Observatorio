2025-10-25 12:33:19,018 - conexion - ERROR - Error al conectar a la base de datos: (mysql.connector.errors.ProgrammingError) 1049 (42000): Unknown database 'observatorio_bilinguismo'
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\mysql\connector\connection_cext.py", line 354, in _open_connection
    self._cmysql.connect(**cnx_kwargs)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
_mysql_connector.MySQLInterfaceError: Unknown database 'observatorio_bilinguismo'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\engine\base.py", line 3301, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\pool\base.py", line 711, in checkout
    rec = pool._do_get()
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\pool\impl.py", line 175, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\pool\base.py", line 673, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\pool\base.py", line 899, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\pool\base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\engine\create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\engine\default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\mysql\connector\pooling.py", line 322, in connect
    return CMySQLConnection(*args, **kwargs)
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\mysql\connector\connection_cext.py", line 142, in __init__
    self.connect(**kwargs)
    ~~~~~~~~~~~~^^^^^^^^^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\mysql\connector\abstracts.py", line 1604, in connect
    self._open_connection()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\mysql\connector\connection_cext.py", line 360, in _open_connection
    raise get_mysql_exception(
        err.errno, msg=err.msg, sqlstate=err.sqlstate
    ) from err
mysql.connector.errors.ProgrammingError: 1049 (42000): Unknown database 'observatorio_bilinguismo'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\Base_datos\conexion.py", line 16, in <module>
    with engine.connect() as connection:
         ~~~~~~~~~~~~~~^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\engine\base.py", line 3277, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\engine\base.py", line 145, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\engine\base.py", line 2440, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\engine\base.py", line 3301, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\pool\base.py", line 711, in checkout
    rec = pool._do_get()
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\pool\impl.py", line 175, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\pool\base.py", line 673, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\pool\base.py", line 899, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\pool\base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\engine\create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\sqlalchemy\engine\default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\mysql\connector\pooling.py", line 322, in connect
    return CMySQLConnection(*args, **kwargs)
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\mysql\connector\connection_cext.py", line 142, in __init__
    self.connect(**kwargs)
    ~~~~~~~~~~~~^^^^^^^^^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\mysql\connector\abstracts.py", line 1604, in connect
    self._open_connection()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\Proyectos Jc Code\Archivos para BD rionegro\Observatorio\env\Lib\site-packages\mysql\connector\connection_cext.py", line 360, in _open_connection
    raise get_mysql_exception(
        err.errno, msg=err.msg, sqlstate=err.sqlstate
    ) from err
sqlalchemy.exc.ProgrammingError: (mysql.connector.errors.ProgrammingError) 1049 (42000): Unknown database 'observatorio_bilinguismo'
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-25 18:54:33,021 - __main__ - ERROR - Fatal error during data import: nan
2025-10-25 18:55:55,219 - __main__ - ERROR - Registros con NOMBRES2 faltante: 8
2025-10-25 18:55:55,221 - __main__ - ERROR - Registros con APELLIDOS faltante: 8
2025-10-25 18:55:55,223 - __main__ - ERROR - Registros con NÚMERO DE IDENTIFICACIÓN faltante: 8
2025-10-25 18:55:55,369 - __main__ - ERROR - Error inserting data into Nivel_MCER: (mysql.connector.errors.InterfaceError) Failed executing the operation; Python type NivelMCERType cannot be converted
[SQL: INSERT INTO `Nivel_MCER` (`NIVEL_MCER`, `POBLACIÓN`, `ESTADO ETAPA 2`, `FECHA ACTUAL`, `ID`) VALUES (%(NIVEL_MCER)s, %(POBLACIÓN)s, %(ESTADO_ETAPA_2)s, %(FECHA_ACTUAL)s, %(ID)s)]
[parameters: [{'NIVEL_MCER': <NivelMCERType.SIN_DIAGNOSTICO: 'SIN DIAGNOSTICO'>, 'POBLACIÓN': None, 'ESTADO_ETAPA_2': None, 'FECHA_ACTUAL': None, 'ID': 1}, {'NIVEL_MCER': <NivelMCERType.SIN_DIAGNOSTICO: 'SIN DIAGNOSTICO'>, 'POBLACIÓN': 'R', 'ESTADO_ETAPA_2': 'Aprobado', 'FECHA_ACTUAL': '25/10/2025', 'ID': 2}, {'NIVEL_MCER': <NivelMCERType.SIN_DIAGNOSTICO: 'SIN DIAGNOSTICO'>, 'POBLACIÓN': 'Niños', 'ESTADO_ETAPA_2': '2025', 'FECHA_ACTUAL': '25/10/2025', 'ID': 3}, {'NIVEL_MCER': <NivelMCERType.SIN_DIAGNOSTICO: 'SIN DIAGNOSTICO'>, 'POBLACIÓN': 'Adolescentes', 'ESTADO_ETAPA_2': 'Aprobado', 'FECHA_ACTUAL': '25/10/2025', 'ID': 4}, {'NIVEL_MCER': <NivelMCERType.SIN_DIAGNOSTICO: 'SIN DIAGNOSTICO'>, 'POBLACIÓN': 'Adolescentes', 'ESTADO_ETAPA_2': '2025', 'FECHA_ACTUAL': '25/10/2025', 'ID': 5}, {'NIVEL_MCER': <NivelMCERType.SIN_DIAGNOSTICO: 'SIN DIAGNOSTICO'>, 'POBLACIÓN': 'Adolescentes ', 'ESTADO_ETAPA_2': '2025', 'FECHA_ACTUAL': '25/10/2025', 'ID': 6}, {'NIVEL_MCER': <NivelMCERType.SIN_DIAGNOSTICO: 'SIN DIAGNOSTICO'>, 'POBLACIÓN': 'Infantil', 'ESTADO_ETAPA_2': '2025', 'FECHA_ACTUAL': '25/10/2025', 'ID': 7}, {'NIVEL_MCER': <NivelMCERType.SIN_DIAGNOSTICO: 'SIN DIAGNOSTICO'>, 'POBLACIÓN': 'Niños', 'ESTADO_ETAPA_2': 'Aprobado', 'FECHA_ACTUAL': '25/10/2025', 'ID': 8}  ... displaying 10 of 16 total bound parameter sets ...  {'NIVEL_MCER': <NivelMCERType.SIN_DIAGNOSTICO: 'SIN DIAGNOSTICO'>, 'POBLACIÓN': 'R', 'ESTADO_ETAPA_2': None, 'FECHA_ACTUAL': '25/10/2025', 'ID': 15}, {'NIVEL_MCER': <NivelMCERType.SIN_DIAGNOSTICO: 'SIN DIAGNOSTICO'>, 'POBLACIÓN': None, 'ESTADO_ETAPA_2': None, 'FECHA_ACTUAL': None, 'ID': 16}]]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-10-25 18:55:55,371 - __main__ - ERROR - Fatal error during data import: (mysql.connector.errors.InterfaceError) Failed executing the operation; Python type NivelMCERType cannot be converted
[SQL: INSERT INTO `Nivel_MCER` (`NIVEL_MCER`, `POBLACIÓN`, `ESTADO ETAPA 2`, `FECHA ACTUAL`, `ID`) VALUES (%(NIVEL_MCER)s, %(POBLACIÓN)s, %(ESTADO_ETAPA_2)s, %(FECHA_ACTUAL)s, %(ID)s)]
[parameters: [{'NIVEL_MCER': <NivelMCERType.SIN_DIAGNOSTICO: 'SIN DIAGNOSTICO'>, 'POBLACIÓN': None, 'ESTADO_ETAPA_2': None, 'FECHA_ACTUAL': None, 'ID': 1}, {'NIVEL_MCER': <NivelMCERType.SIN_DIAGNOSTICO: 'SIN DIAGNOSTICO'>, 'POBLACIÓN': 'R', 'ESTADO_ETAPA_2': 'Aprobado', 'FECHA_ACTUAL': '25/10/2025', 'ID': 2}, {'NIVEL_MCER': <NivelMCERType.SIN_DIAGNOSTICO: 'SIN DIAGNOSTICO'>, 'POBLACIÓN': 'Niños', 'ESTADO_ETAPA_2': '2025', 'FECHA_ACTUAL': '25/10/2025', 'ID': 3}, {'NIVEL_MCER': <NivelMCERType.SIN_DIAGNOSTICO: 'SIN DIAGNOSTICO'>, 'POBLACIÓN': 'Adolescentes', 'ESTADO_ETAPA_2': 'Aprobado', 'FECHA_ACTUAL': '25/10/2025', 'ID': 4}, {'NIVEL_MCER': <NivelMCERType.SIN_DIAGNOSTICO: 'SIN DIAGNOSTICO'>, 'POBLACIÓN': 'Adolescentes', 'ESTADO_ETAPA_2': '2025', 'FECHA_ACTUAL': '25/10/2025', 'ID': 5}, {'NIVEL_MCER': <NivelMCERType.SIN_DIAGNOSTICO: 'SIN DIAGNOSTICO'>, 'POBLACIÓN': 'Adolescentes ', 'ESTADO_ETAPA_2': '2025', 'FECHA_ACTUAL': '25/10/2025', 'ID': 6}, {'NIVEL_MCER': <NivelMCERType.SIN_DIAGNOSTICO: 'SIN DIAGNOSTICO'>, 'POBLACIÓN': 'Infantil', 'ESTADO_ETAPA_2': '2025', 'FECHA_ACTUAL': '25/10/2025', 'ID': 7}, {'NIVEL_MCER': <NivelMCERType.SIN_DIAGNOSTICO: 'SIN DIAGNOSTICO'>, 'POBLACIÓN': 'Niños', 'ESTADO_ETAPA_2': 'Aprobado', 'FECHA_ACTUAL': '25/10/2025', 'ID': 8}  ... displaying 10 of 16 total bound parameter sets ...  {'NIVEL_MCER': <NivelMCERType.SIN_DIAGNOSTICO: 'SIN DIAGNOSTICO'>, 'POBLACIÓN': 'R', 'ESTADO_ETAPA_2': None, 'FECHA_ACTUAL': '25/10/2025', 'ID': 15}, {'NIVEL_MCER': <NivelMCERType.SIN_DIAGNOSTICO: 'SIN DIAGNOSTICO'>, 'POBLACIÓN': None, 'ESTADO_ETAPA_2': None, 'FECHA_ACTUAL': None, 'ID': 16}]]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-10-25 18:59:04,071 - __main__ - ERROR - Fatal error during data import: 'FECHA_ACTUAL'
2025-10-25 19:00:31,758 - __main__ - ERROR - Error durante la limpieza de datos de Personas: 'NÚMERO DE IDENTIFICACIÓN'
2025-10-25 19:00:31,758 - __main__ - ERROR - Fatal error during data import: 'NÚMERO DE IDENTIFICACIÓN'
2025-10-25 19:01:47,575 - __main__ - ERROR - Error durante la limpieza de datos de Personas: cannot access local variable 'invalid_dates' where it is not associated with a value
2025-10-25 19:01:47,576 - __main__ - ERROR - Fatal error during data import: cannot access local variable 'invalid_dates' where it is not associated with a value
2025-10-25 19:02:08,607 - __main__ - ERROR - Error durante la limpieza de datos de Personas: cannot access local variable 'invalid_dates' where it is not associated with a value
2025-10-25 19:02:08,607 - __main__ - ERROR - Fatal error during data import: cannot access local variable 'invalid_dates' where it is not associated with a value
